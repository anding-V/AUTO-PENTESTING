import os
import subprocess
from reportlab.lib.pagesizes import letter
from reportlab.pdfgen import canvas

def Webvulscan1(host, port):
    # Exécuter la commande Nikto
    process = subprocess.Popen(['nikto', '-h', host, '-p', port], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    stdout, stderr = process.communicate()
    return stdout.decode('utf-8')

def generate_pdf(output, filename=f'nikto_scan_output_.pdf'):
    # Générer un fichier PDF avec la sortie de Nikto
    path = os.path.join(os.getcwd(), 'scan', 'webvuln')
    if not os.path.exists(path):
        os.makedirs(path)
    filepath = os.path.join(path, filename)
    c = canvas.Canvas(filepath, pagesize=letter)
    c.drawString(100, 750, "Nikto Scan Output:")
    y = 730
    for line in output.split('\n'):
        c.drawString(100, y, line)
        y -= 12
    c.save()
    print(f"PDF generated: {filepath}")
'''
if __name__ == "__main__":
    host = input("Enter the target IP or domain name: ")
    port = input("Enter the target port (press Enter for default port 80): ") or "80"
    output = Webvulscan1(host, port)
    generate_pdf(output)'''
