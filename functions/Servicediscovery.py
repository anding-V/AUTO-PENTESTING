import nmap

def Execservicedis(target):

  nm = nmap.PortScanner()
  scan_info = nm.scan(target, arguments='-sV -Pn -p-')  # Scan all ports

  for port, state in scan_info['scan'][target]['tcp'].items():
    if state['state'] == 'open':
      service_name = scan_info['scan'][target]['tcp'][port].get('name', '')
      service_version = scan_info['scan'][target]['tcp'][port].get('version', '')
      print(f"Port : {port} State : {state['state']} Service : {service_name} ({service_version})")
