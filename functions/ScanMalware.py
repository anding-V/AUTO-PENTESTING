import subprocess
import ipaddress

def run_nmap_malware_script(target_ip):
    try:
        # Construct the nmap command
        command = ["nmap", "--script", "malware", target_ip]

        # Run the command
        subprocess.run(command, check=True)
    except subprocess.CalledProcessError as e:
        print("Error executing command:", e)
    except FileNotFoundError:
        print("Nmap command not found. Make sure it is installed and in the PATH.")

def validate_ip(ip):
    try:
        ipaddress.ip_address(ip)
        return True
    except ValueError:
        return False

def main():
    while True:
        # Prompt the user for the target IP address
        target_ip = input("Enter the target IP address: ").strip()

        # Validate the IP address format
        if not validate_ip(target_ip):
            print("Invalid IP address format. Please enter a valid IP address.")
            continue

        # Run nmap with the malware script against the target IP
        run_nmap_malware_script(target_ip)
        break

if __name__ == "__main__":
    main()