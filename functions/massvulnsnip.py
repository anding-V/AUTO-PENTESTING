import subprocess
import socket

def run_sniper_command(command):
    try:
        subprocess.run(command, shell=True, check=True)
    except subprocess.CalledProcessError as e:
        print("Error executing command:", e)
    except Exception as e:
        print("An error occurred:", e)

def validate_ip(ip):
    try:
        socket.inet_aton(ip)
        return True
    except socket.error:
        return False

def prompt_user_for_ip():
    while True:
        ip = input("Enter the target IP address: ").strip()
        if not ip:
            print("IP address is required.")
            continue
        if not validate_ip(ip):
            print("Invalid IP address format. Please enter a valid IPv4 address.")
            continue
        return ip

def prompt_user_for_scan_name():
    while True:
        scan_name = input("Enter the name of the scan: ").strip()
        if not scan_name:
            print("Scan name is required.")
            continue
        return scan_name

def exec_auto_pentest():
    target_ip = prompt_user_for_ip()
    scan_name = prompt_user_for_scan_name()
    command = f"sniper -t {target_ip} -m normal -w {scan_name}"
    run_sniper_command(command)


