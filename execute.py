from menu import displayHeader, displayMenu, SubMenu1,SubMenu2,SubMenu3,SubMenu4
from colorama import Fore, Back, Style, init
from functions.whoisSub1 import whois_query
from functions.dnsSub1 import get_dns_records
from functions.VulnScan import scan_vuln

if __name__ == "__main__":

    init()
    displayHeader()
    displayMenu()


    while True:
        try:
            option = int(input(">>> Choose an option\n>>> "))
            if not (0 <= option <= 8):
                raise ValueError
        except ValueError:
            print(f'{Fore.RED}WRONG OPTION NUMBER! PLEASE ENTER AN INTEGER BETWEEN 1 AND 9{Style.RESET_ALL}')
            displayMenu()
            continue

        if option == 1:
            while True:
                SubMenu1()
                subOption = input(">>> Choose an option\n>>> ")
                if subOption == 'a':
                    domain = input(">>> Type a domain name\n>>> ")
                    print(whois_query(domain))
                elif subOption == 'b':
                    domain_name = input(">>> Type a domain name\n>>> ")
                    whois_lookup(domain_name)
                elif subOption == 'c':
                    DNS_DOMAIN = input(">>> Enter a domain name\n>>> ")
                    dns_lookup = get_dns_records(DNS_DOMAIN)
                    print(dns_lookup)
                elif subOption == 'd':
                    CERTIF = input(">>> Enter a domain name\n>>> ")
                    certif = getCertificate(CERTIF)
                    print(certif)
                elif subOption == '0':
                    displayMenu()
                    break  # Exit the submenu loop

        elif option == 2:
            while True:
                SubMenu2()
                subOption = input(">>> Choose an option\n>>> ")
                if subOption == 'a':
                    TARGET = input(">>> Type target domain or IP\n>>> ")
                    scan, version = Nmap(TARGET)
                    print(scan)
                elif subOption == 'b':
                    URL = input(">>> Type target URL (http://example.com/)\n>>> ")
                    check_server(URL, False)
                    check_robots_txt(URL)
                    find_github(URL)
                elif subOption == 'c':
                    URL = input(">>> Type target URL (http://example.com/)\n>>> ")
                    print(f">>> {Fore.GREEN}[+] Starting a dirbuster scan {Style.RESET_ALL}")
                    url_discover(URL)
                elif subOption == '0':
                    displayMenu()
                    break  # Exit the submenu loop

        # Add elif blocks for options 3, 4, etc.

        elif option == 0:
            print(f'{Fore.BLUE}Thanks for using A.V Toolbox for your Pentesting{Style.RESET_ALL}')
            break  # Exit the main loop


        elif option == 3:
            while True:
                SubMenu3()
                subOption = str(input(">>> Choose an option\n>>> "))

                if subOption == 'a':
                    service = str(input(">>> Search for exploits on a service (ex: wordpress 4.0)\n>>> "))
                    exploit = searchsploit(service)
                    print(exploit)

                if subOption == 'b':
                    service = str(input(">>> Search for exploits on a service (ex: wordpress 4.0)\n>>> "))
                    exploit = searchsploit(service)
                    print(exploit)

                elif subOption == '0':
                    displayMenu()
                    subOption = str(input(">>> Choose an option\n>>> "))

        elif option == 4:



                # Get target and port from user input
                target = input("Enter the target domain or IP address: ")
                port = input("Enter the port number to scan (press Enter for default): ")

                # If port is not provided, use default (port 80)
                if not port:
                    port = "80"
                scan_vuln(target, port)


                '''if subOption == 'a':
                    user = str(input(">>> Enter a username\n>>> "))
                    usernamecheck = checkusername(user)
                    print(usernamecheck)

                elif subOption == 'b':
                    numberphone = str(input(">>> Enter a phone number in international format (ex: 33969370364)\n>>> "))
                    phone = lookuphone(numberphone)
                    print(phone)

                elif subOption == 'c':
                    local = 'fr_FR'
                    fake_identity = generate_fake_identity(local)
                    print(fake_identity)

                elif subOption == 'd':
                    querys = str(input('>>> Enter a dorks requests (ex: "mommy" filetype:pdf)\n>>> '))
                    dorkquery = dorks(querys)
                    print(dorkquery)


                elif subOption == '0':
                    displayMenu()
                    subOption = str(input(">>> Choose an option\n>>> "))'''

        elif option == 0:
            print(f'{Fore.BLUE}Thanks for using A.V Toolbox for your Pentestsing{Style.RESET_ALL}')
            break

