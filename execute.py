from menu import displayHeader, displayMenu, SubMenu1,SubMenu2,SubMenu3,SubMenu4
from colorama import Fore, Back, Style, init

if __name__ == "__main__":

    init()
    displayHeader()
    displayMenu()

    option = int(input(">>> Choose an option\n>>> "))

    while option != 99:

        if option == 1:
            SubMenu1()
            subOption = str(input(">>> Choose an option\n>>> "))
            while subOption != 'z':

                if subOption == 'a':
                    domain = str(input(">>> Type a domain name\n>>> "))
                    print(whois_query(domain))

                if subOption == 'b':
                    CVE_ID = str(input(">>> Enter a CVE id (ex: CVE-2021-40438)\n>>> "))
                    print(CVELookUp(CVE_ID))

                if subOption == 'c':
                    DNS_DOMAIN = str(input(">>> Enter a domain name\n>>> "))
                    dns_lookup = DNSLookUp(DNS_DOMAIN)
                    print(dns_lookup)

                if subOption == 'd':
                    CERTIF = str(input(">>> Enter a domain name\n>>> "))
                    certif = getCertificate(CERTIF)
                    print(certif)

                ReconMenu()
                subOption = str(input(">>> Choose an option\n>>> "))


        elif option == 2:
            ScanningMenu()
            subOption = str(input(">>> Choose an option\n>>> "))
            while subOption != 'z':

                if subOption == 'a':
                    TARGET = str(input(">>> Type target domain or IP\n>>> "))
                    scan, version = Nmap(TARGET)
                    print(scan)

                if subOption == 'b':
                    URL = str(input(">>> Type target URL (http://example.com/)\n>>> "))
                    check_server(URL, False)
                    check_robots_txt(URL)
                    find_github(URL)

                if subOption == 'c':
                    URL = str(input(">>> Type target URL (http://example.com/)\n>>> "))
                    print(f">>> {Fore.GREEN}[+] Starting a dirbuster scan {Style.RESET_ALL}")
                    url_discover(URL)

                ScanningMenu()
                subOption = str(input(">>> Choose an option\n>>> "))

        elif option == 3:
            ExploitMenu()
            subOption = str(input(">>> Choose an option\n>>> "))
            while subOption != 'z':

                if subOption == 'a':
                    service = str(input(">>> Search for exploits on a service (ex: wordpress 4.0)\n>>> "))
                    exploit = searchsploit(service)
                    print(exploit)

                ExploitMenu()
                subOption = str(input(">>> Choose an option\n>>> "))

        elif option == 4:
            OsintMenu()
            subOption = str(input(">>> Choose an option\n>>> "))
            while subOption != 'z':

                if subOption == 'a':
                    user = str(input(">>> Enter a username\n>>> "))
                    usernamecheck = checkusername(user)
                    print(usernamecheck)

                if subOption == 'b':
                    numberphone = str(input(">>> Enter a phone number in international format (ex: 33969370364)\n>>> "))
                    phone = lookuphone(numberphone)
                    print(phone)

                if subOption == 'c':
                    local = 'fr_FR'
                    fake_identity = generate_fake_identity(local)
                    print(fake_identity)

                if subOption == 'd':
                    querys = str(input('>>> Enter a dorks requests (ex: "mommy" filetype:pdf)\n>>> '))
                    dorkquery = dorks(querys)
                    print(dorkquery)

                OsintMenu()
                subOption = str(input(">>> Choose an option\n>>> "))
