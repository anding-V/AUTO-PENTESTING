import re
import subprocess


def validate_ip(ip):
    # Regular expression to validate IP address
    ip_pattern = r'^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$'
    return re.match(ip_pattern, ip)


def perform_nmap_scan(ip):
    # Nmap command to perform the scan
    nmap_command = f"nmap -sX -T4 {ip}"

    # Execute the command and capture the output
    try:
        output = subprocess.check_output(nmap_command, shell=True, universal_newlines=True)
        print(output)
    except subprocess.CalledProcessError as e:
        print(f"An error occurred: {e}")


if __name__ == "__main__":
    while True:
        ip = input("Enter the target IP address: ")
        if validate_ip(ip):
            break
        else:
            print("Invalid IP address format. Please enter a valid IP address.")

    perform_nmap_scan(ip)
