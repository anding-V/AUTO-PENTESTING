import subprocess

def run_sniper_command(command):
    # Exécuter la commande Sniper
    try:
        subprocess.run(command, shell=True, check=True)
    except subprocess.CalledProcessError as e:
        print("Erreur lors de l'exécution de la commande :", e)
    except Exception as e:
        print("Une erreur s'est produite :", e)

def prompt_user_for_number_of_hosts():
    # Demander à l'utilisateur le nombre d'hôtes à scanner
    num_hosts = int(input("Entrez le nombre d'hôtes à scanner : "))
    return num_hosts

def prompt_user_for_ips(num_hosts):
    # Demander à l'utilisateur de saisir les adresses IP des hôtes
    print("Entrez les adresses IP des hôtes (séparées par des espaces) :")
    ips = input().strip().split()

    # Vérifier si le nombre d'adresses IP correspond au nombre d'hôtes attendus
    if len(ips) != num_hosts:
        print(f"Vous avez entré {len(ips)} adresses IP. Le nombre d'adresses IP doit correspondre au nombre d'hôtes spécifié.")
        exit(1)

    # Écrire les adresses IP dans le fichier target.txt
    with open("target.txt", "w") as file:
        file.write("\n".join(ips))

def prompt_user_for_scan_name():
    # Demander à l'utilisateur de saisir le nom du scan
    scan_name = input("Entrez le nom du scan : ")
    return scan_name

if __name__ == "__main__":
    # Demander à l'utilisateur le nombre d'hôtes à scanner
    num_hosts = prompt_user_for_number_of_hosts()

    # Demander à l'utilisateur de saisir les adresses IP des hôtes
    prompt_user_for_ips(num_hosts)

    # Demander à l'utilisateur de saisir le nom du scan
    scan_name = prompt_user_for_scan_name()

    # Exécuter la commande Sniper
    command = f"sniper -f target.txt -m massvulnscan -w {scan_name}"
    run_sniper_command(command)
