import os
import subprocess
import pdfkit

def run_nikto_scan(host, port):
    # Exécuter la commande Nikto et récupérer la sortie brute
    process = subprocess.Popen(['nikto', '-h', host, '-p', str(port)], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    stdout, stderr = process.communicate()
    return stdout.decode('utf-8')

if __name__ == "__main__":
    host = "192.168.128.2" # input("Enter the target IP or domain name: ")
    port = 80 #input("Enter the target port (press Enter for default port 443): ") or "443"
    nikto_output = run_nikto_scan(host, port)

    # Encapsuler la sortie brute de Nikto dans une balise <pre>
    html_output = f"<pre>{nikto_output}</pre>"

    # Enregistrer le rapport HTML
    html_file = 'nikto_scan_report.html'
    with open(html_file, 'w') as f:
        f.write(html_output)

    # Convertir le HTML en PDF avec une taille de page paysage
    pdf_file = 'nikto_scan_report.pdf'
    options = {
        'page-size': 'Letter',
        'orientation': 'Landscape'
    }
    pdfkit.from_file(html_file, pdf_file, options=options)

    print(f"PDF report generated: {pdf_file}")
